import{u as ee,r,a as se,j as e,H as te,L as d}from"./app-DkRx041o.js";import{A as ae,c as le}from"./AuthenticatedLayout-BBmiB4YK.js";import{C as i}from"./index.esm-Tsoq4lH0.js";import{S as a}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as re,S as ie}from"./SecondaryButton-Dn_lAqoU.js";import{I as h}from"./InputLabel-QI8e4bbR.js";import{S as p}from"./react-select.esm-Cuj-hhH4.js";import{I as x}from"./InputError-BFv80niq.js";import{P as S}from"./PrimaryButton-BLEpz937.js";import{T as oe}from"./TextInput-C_aPt-id.js";import{c as ce}from"./cil-library-add-Cbli5Ji_.js";import{c as ne}from"./cil-playlist-add-BUGnrIkn.js";import{c as de}from"./cil-menu-Za6MY1fF.js";import{c as me}from"./cil-check-Dqg5Ixbd.js";import{c as ue}from"./cil-pencil-m516yCOw.js";import{c as he}from"./cil-delete-tImhsUUb.js";import{c as C}from"./cil-save-CHBg7z_U.js";import"./transition-DqkGsXNU.js";import"./ApplicationLogo-Cd4uk-mF.js";import"./logo-CPzApIsd.js";function Fe({devoirs:N,schools:f,trimestres:L,matieres:$,classes:O}){const M=ee().props.auth.permissions,c=s=>M.some(t=>t.name==s),[j,_]=r.useState(N.data.map(s=>({id:s.id,checked:s.is_validated}))),[D,w]=r.useState(!1),[B,F]=r.useState(!1),[v,T]=r.useState(L.data),[V,A]=r.useState(!1),[g,E]=r.useState($.data),[q,z]=r.useState(!1),[b,I]=r.useState(O.data),{data:m,patch:P,get:R,post:H,errors:u,processing:y,setData:n,reset:G,delete:X}=se({school_id:"",trimestre_id:"",classe_id:"",matiere_id:"",devoirscheckeds:[]}),J=s=>{n("school_id",s.value);const t=f.data.find(l=>l.id===s.value);console.log("Ã‰cole sÃ©lectionnÃ©e :",t),console.log("Trimestres :",t.trimestres),console.log("MatiÃ¨res :",t.matieres),console.log("Classes :",t.classes),T(t.trimestres),F(!0),E(t.matieres),A(!0),I(t.classes),z(!0)},K=(s,t)=>{s.preventDefault(),a.fire({title:"OpÃ©ration en cours...",text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{a.showLoading()}}),P(route("devoir.valide",t.id),{onSuccess:()=>{a.close(),a.fire({icon:"success",title:"OpÃ©ration rÃ©ussie",text:"Devoir validÃ© avec succÃ¨s"})},onError:l=>{a.close(),a.fire({icon:"error",title:"OpÃ©ration Ã©chouÃ©e",text:`${l.exception??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`}),console.log(l)}})},Q=s=>{s.preventDefault(),w(!0)},k=()=>{w(!1),G()};r.useEffect(()=>{let s=j.filter(t=>t.checked);n("devoirscheckeds",s),console.log("Finals dats to send :",s)},[j]);const U=(s,t,l)=>{t.preventDefault();let o=[...j];t.target.checked?(o[s].checked=!0,console.log("updated true....: ",o),_(o)):(o[s].checked=!1,console.log("updated false....: ",o),_(o))},W=s=>{s.preventDefault(),a.fire({title:"OpÃ©ration en cours...",text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{a.showLoading()}}),H(route("devoir.validate-multiple"),{onSuccess:()=>{a.close(),a.fire({icon:"success",title:"OpÃ©ration Ã©ffectuÃ©e!",text:"Devoirs validÃ©es avec succÃ¨s!"})},onError:t=>{a.close(),a.fire({icon:"error",title:"OpÃ©ration Ã©chouÃ©e",text:`${t.exception??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`}),console.log(t)}})},Y=s=>{s.preventDefault(),a.fire({title:"OpÃ©ration en cours...",text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{a.showLoading()}}),R(route("devoir.get-store-multiple"),{onSuccess:()=>{a.close()},onError:t=>{a.close(),a.fire({icon:"error",title:"OpÃ©ration Ã©chouÃ©e",text:`${t.exception??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`}),console.log(t)}})},Z=(s,t)=>{s.preventDefault(),a.fire({title:'<span style="color: #facc15;">âš ï¸ ÃŠtes-vous sÃ»r ?</span>',text:"Le devoir sera supprimÃ© de faÃ§on permanente !",showCancelButton:!0,confirmButtonColor:"#2a7348",cancelButtonColor:"#3085d6",confirmButtonText:"ğŸ˜‡ Oui, supprimer !",cancelButtonText:"Annuler"}).then(l=>{l.isConfirmed&&(a.fire({title:'<span style="color: #facc15;">ğŸ«  Suppression en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{a.showLoading()}}),X(route("devoir.destroy",t.id),{onSuccess:()=>{a.close(),a.fire({title:'<span style="color: #2a7348;">ğŸ‘ŒSuppression rÃ©ussie </span>',text:"Le devoir a Ã©tÃ© supprimÃ© avec succÃ¨s.",confirmButtonText:"ğŸ˜‡ Fermer"})},onError:o=>{a.close(),a.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ Suppression Ã©chouÃ©e </span>',text:`${o.exception??"Veuillez rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"})}}))})};return e.jsxs(ae,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(i,{className:"text-success",icon:le})," Panel des devoirs"]}),children:[e.jsx(te,{title:"Les devoirs d'Ã©coles"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[c("interrogation.create")?e.jsxs("div",{className:"  items-center gap-4",children:[e.jsxs(d,{className:"btn btn-sm bg-success bg-hover text-white",href:route("devoir.create"),children:[" ",e.jsx(i,{className:"",icon:ce})," Ajouter"]}),e.jsxs(d,{className:"btn btn-sm bg-success bg-hover text-white mx-3",href:"#",onClick:s=>Q(s),children:[" ",e.jsx(i,{className:"",icon:ne})," Faire un ajout groupÃ©"]})]}):null,e.jsxs("form",{onSubmit:W,children:[e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Action"}),e.jsx("th",{scope:"col",children:"Statut"}),e.jsx("th",{scope:"col",children:"Ecole"}),e.jsx("th",{scope:"col",children:"Apprenant"}),e.jsx("th",{scope:"col",children:"Trimestre"}),e.jsx("th",{scope:"col",children:"Matiere"}),e.jsx("th",{scope:"col",children:"Note"}),e.jsx("th",{scope:"col",children:"InserÃ©e par"})]})}),e.jsx("tbody",{children:N.data.map((s,t)=>e.jsxs("tr",{className:`bg-${s.is_validated?"success":"danger"}`,children:[e.jsxs("th",{scope:"row",children:[t+1,c("devoir.edit")?s.is_validated?null:e.jsx(oe,{type:"checkbox",className:"form-control mt-1 block w-full",onChange:l=>U(t,l)}):null]}),e.jsx("td",{className:"text-center",children:s.is_validated?"--":e.jsxs("div",{className:"dropstart",children:[e.jsxs("button",{type:"button",className:"dropdown-toggle items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx(i,{icon:de})," GÃ©rer"]}),e.jsxs("ul",{className:"dropdown-menu p-2 border rounded shadow","aria-labelledby":"dropdownMenuButton1",children:[c("devoir.edit")?e.jsx("li",{children:e.jsxs(d,{className:"btn btn-success text-white w-100",onClick:l=>K(l,s),children:[e.jsx(i,{icon:me}),"  Valider"]})}):null,c("devoir.edit")?e.jsx("li",{children:e.jsxs(d,{className:"btn text-warning",href:route("devoir.edit",s.id),children:[e.jsx(i,{icon:ue}),"  Modifier"]})}):null,c("devoir.delete")?e.jsx("li",{children:e.jsxs(d,{className:"btn text-danger",onClick:l=>Z(l,s),children:[e.jsx(i,{icon:he}),"  Supprimer"]})}):null]})]})}),e.jsx("td",{children:e.jsx("span",{className:`btn btn-sm badge bg-${s.is_validated?"success":"danger"} border rounded text-light`,children:s.is_validated?e.jsx(e.Fragment,{children:"ValidÃ©e"}):e.jsx(e.Fragment,{children:"Non validÃ©e"})})}),e.jsx("td",{children:s.school?.raison_sociale??"---"}),e.jsx("td",{children:`${s.apprenant?.firstname} - ${s.apprenant?.lastname}`}),e.jsx("td",{children:s.trimestre?.libelle}),e.jsx("td",{children:s.matiere?.libelle}),e.jsx("td",{children:e.jsxs("span",{className:"badge bg-light text-dark border rounded",children:[" ",s.note??"00"]})}),e.jsx("td",{children:e.jsxs("span",{className:"badge bg-light text-dark border rounded",children:[" ",`${s.createdBy?.firstname} - ${s.createdBy?.lastname}`]})})]},s.id))})]}),e.jsx("br",{}),e.jsx("div",{className:"row justify-content-center d-flex",children:e.jsx("div",{className:"col-6",children:e.jsxs(S,{className:"ms-3 w-50",disabled:y,children:[e.jsx(i,{icon:C}),"  Valider ma selection"]})})})]})]})})}),e.jsx(re,{show:D,onClose:k,children:e.jsxs("form",{onSubmit:Y,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Ajout groupÃ© des devoirs"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"school_id",value:"L'Ã©cole concernÃ©e",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher une Ã©cole ...",name:"school_id",id:"school_id",required:!0,className:"form-control mt-1 block w-full",options:f.data.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:f.data.map(s=>({value:s.id,label:`${s.raison_sociale}`,trimestres:s.trimestres})).find(s=>s.value===m.school_id),onChange:s=>J(s)}),e.jsx(x,{className:"mt-2",message:u.school_id})]})}),B&&v.length>0&&e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"trimestre_id",value:"Le trimestre concernÃ©",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher un trimestre ...",name:"trimestre_id",id:"trimestre_id",required:!0,className:"form-control mt-1 block w-full",options:v.map(s=>({value:s.id,label:`${s.libelle}`})),value:v.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===m.trimestre_id),onChange:s=>n("trimestre_id",s.value)}),e.jsx(x,{className:"mt-2",message:u.trimestre_id})]})}),V&&g.length>0&&e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"matiere_id",value:"La matiÃ¨re concernÃ©e",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher une matiÃ¨re ...",name:"matiere_id",id:"matiere_id",required:!0,className:"form-control mt-1 block w-full",options:g.map(s=>({value:s.id,label:`${s.libelle}`})),value:g.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===m.matiere_id),onChange:s=>n("matiere_id",s.value)}),e.jsx(x,{className:"mt-2",message:u.matiere_id})]})}),q&&b.length>0&&e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"classe_id",value:"La classe concernÃ©e",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher une classe ...",name:"classe_id",id:"classe_id",required:!0,className:"form-control mt-1 block w-full",options:b.map(s=>({value:s.id,label:`${s.libelle}`})),value:b.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===m.classe_id),onChange:s=>n("classe_id",s.value)}),e.jsx(x,{className:"mt-2",message:u.classe_id})]})})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(ie,{onClick:k,children:"Abandonner"}),e.jsxs(S,{className:"ms-3",disabled:y,children:[e.jsx(i,{icon:C}),"  Filtrer la selection"]})]})]})})]})}export{Fe as default};
