import{u as z,r as m,a as B,j as e,H as q,L as h}from"./app-COXuoshf.js";import{A as F,c as V}from"./AuthenticatedLayout-DMkp4Po-.js";import{C as o}from"./index.esm-D1uZLHD8.js";import{S as r}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as N,S as w}from"./SecondaryButton-D8qI_iSY.js";import{I as y}from"./InputLabel-D08De8It.js";import{T as v}from"./TextInput-106aKHgy.js";import{I as k}from"./InputError-B4Bc12od.js";import{P as S}from"./PrimaryButton-CPr2P8Vf.js";import{c as H}from"./cil-library-add-Cbli5Ji_.js";import{c as C}from"./cil-cloud-download-CPU_poQw.js";import{c as R}from"./cil-menu-Za6MY1fF.js";import{c as I}from"./cil-pencil-m516yCOw.js";import{c as U}from"./cil-delete-tImhsUUb.js";import{c as M}from"./cil-send-haInf9fd.js";import{c as G}from"./cil-info-CmGCY32x.js";import"./transition-jha34rDs.js";import"./ApplicationLogo-B40mcJOu.js";import"./logo-CPzApIsd.js";function xe({apprenants:E}){const L=z().props.auth.permissions,[P,l]=m.useState(!1),[A,a]=m.useState(!1),[c,x]=m.useState(null),i=s=>L.some(t=>t.name==s),D=(s,t)=>{s.preventDefault(),r.fire({text:`Profile de : ${t.parent?.firstname} - ${t.parent?.lastname}`,imageUrl:t.photo,imageWidth:400,imageHeight:200,imageAlt:"Photo de profil",confirmButtonColor:"#1b5a38",confirmButtonText:"Merci"})},O=(s,t)=>{s.preventDefault(),x(t),a(!0)},_=(s,t)=>{s.preventDefault(),x(t),l(!0)},p=()=>{l(!1)},u=()=>{a(!1)},{data:j,setData:f,errors:g,processing:n,post:b,patch:W}=B({photo:"",apprenants:""}),T=s=>{s.preventDefault(),r.fire({title:"Opération en cours...",text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),b(route("apprenant.import"),{onSuccess:()=>{r.close(),r.fire({icon:"success",title:"Opération réussie",text:"Importation effectuée avec succès"}),l(!1)},onError:t=>{r.close(),r.fire({icon:"error",title:"Opération échouée",text:`${t.exception??"Veuillez vérifier vos informations et réessayer."}`}),l(!1)}})},$=s=>{s.preventDefault(),r.fire({title:"Opération en cours...",text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),b(route("apprenant.profile-update",c?.id),{forceFormData:!0,onSuccess:()=>{r.close(),r.fire({icon:"success",title:"Opération réussie",text:"Profile mis à jour avec succès"}),a(!1),console.log("Success",j.photo)},onError:t=>{r.close(),r.fire({icon:"error",title:"Opération échouée",text:`${t.exception??"Veuillez vérifier vos informations et réessayer."}`}),a(!1),console.log("Error",j.photo)}})};return e.jsxs(F,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(o,{className:"text-success",icon:V})," Panel des listes d'apprenants"]}),children:[e.jsx(q,{title:"Les apprenants"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[i("apprenant.create")?e.jsxs("div",{className:"  items-center gap-4",children:[e.jsxs(h,{className:"mx-2 btn btn-sm bg-success bg-hover text-white",href:route("apprenant.create"),children:[" ",e.jsx(o,{className:"",icon:H})," Ajouter"]}),e.jsxs("button",{className:"btn btn-sm bg-success bg-hover text-white",onClick:s=>_(s),children:[" ",e.jsx(o,{className:"",icon:C})," Importer des apprenants"]})]}):null,e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Action"}),e.jsx("th",{scope:"col",children:"Photo"}),e.jsx("th",{scope:"col",children:"Ecole"}),e.jsx("th",{scope:"col",children:"Nom"}),e.jsx("th",{scope:"col",children:"Prénom"}),e.jsx("th",{scope:"col",children:"Parent"}),e.jsx("th",{scope:"col",children:"Classe"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Adresse"}),e.jsx("th",{scope:"col",children:"Phone"}),e.jsx("th",{scope:"col",children:"Sexe"}),e.jsx("th",{scope:"col",children:"Date de naissance"}),e.jsx("th",{scope:"col",children:"Lieu de naissance"}),e.jsx("th",{scope:"col",children:"N° Educ Master"})]})}),e.jsx("tbody",{children:E.data.map((s,t)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:t+1}),e.jsx("td",{children:e.jsxs("div",{className:"dropstart",children:[e.jsxs("button",{type:"button",className:"dropdown-toggle items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx(o,{icon:R})," Gérer"]}),e.jsxs("ul",{className:"dropdown-menu p-2 border rounded shadow","aria-labelledby":"dropdownMenuButton1",children:[i("apprenant.edit")?e.jsx("li",{children:e.jsxs(h,{className:"btn text-warning",href:route("apprenant.edit",s.id),children:[e.jsx(o,{icon:I}),"  Modifier"]})}):null,i("apprenant.delete")?e.jsx("li",{children:e.jsxs(h,{className:"btn text-danger",children:[e.jsx(o,{icon:U}),"  Supprimer"]})}):null]})]})}),e.jsx("td",{children:e.jsxs("div",{className:"badge bg-light d-flex rounded border shadow",children:[e.jsx("img",{src:s.photo,onClick:d=>D(d,s),className:"img-fluid img-circle shadow",srcSet:"",style:{width:"50px",height:"50px",borderRadius:"50%",border:"solid 5px #f6f6f6",cursor:"pointer"}}),i("apprenant.edit")?e.jsx(o,{className:"text-success",style:{cursor:"pointer",width:500},icon:I,onClick:d=>O(d,s)}):"---"]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border text-dark border",children:s.school?.raison_sociale})}),e.jsx("td",{children:s.firstname}),e.jsx("td",{children:s.lastname}),e.jsxs("td",{children:[s.parent?.firstname," ",s.parent?.lastname]}),e.jsxs("td",{children:[s.classe?.libelle||"--"," - ",s.serie?.libelle||"--"," "]}),e.jsx("td",{children:s.email||"--"}),e.jsx("td",{children:s.adresse||"--"}),e.jsx("td",{children:s.phone||"--"}),e.jsx("td",{children:s.sexe||"--"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.date_naissance||"--"})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.lieu_naissance||"--"})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.educ_master||"--"})})]},s.id))})]})]})})}),e.jsx(N,{show:A,onClose:u,children:e.jsxs("form",{onSubmit:$,className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:["Modifier le profil de l'apprenant ",e.jsx("em",{className:"text-success",children:`${c?.firstname} - ${c?.lastname}`})]}),e.jsxs("div",{className:"my-2",children:[e.jsxs(y,{htmlFor:"photo",value:"Les apprenants en fichier excel",children:[" ",e.jsx("span",{className:"text-danger",children:"*"}),"  "]}),e.jsx(v,{type:"file",name:"photo",id:"photo",required:!0,className:"form-control mt-1 block w-full",onChange:s=>f("photo",s.target.files[0])}),e.jsx(k,{className:"mt-2",message:g.photo})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(w,{onClick:u,children:"Abandonner"}),e.jsxs(S,{disabled:n,children:[e.jsx(o,{icon:M})," ",n?"Enregistrement ...":"Enregistrer les modifications"]})]})]})}),e.jsx(N,{show:P,onClose:p,children:e.jsxs("form",{onSubmit:T,className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:["Importation de nouveaux ",e.jsx("em",{className:"text-success",children:"apprenants"})]}),e.jsxs("div",{className:"alert alert-success",children:[e.jsx(o,{className:"text-success",icon:G}),e.jsxs("ul",{className:"",children:[e.jsx("li",{className:"",children:"Télecharger le modèle"}),e.jsx("li",{className:"",children:"Remplissez le modèle"}),e.jsx("li",{className:"",children:"Uploader le fichier remplit"})]})]}),e.jsx("div",{className:"my-2",children:e.jsxs("a",{target:"_blank",href:"/apprenants-model.xlsx",className:"w-100 text-white btn btn-sm bg-success btn-hover",children:[e.jsx(o,{icon:C}),"Télécharger le modèle"]})}),e.jsxs("div",{className:"my-2",children:[e.jsxs(y,{htmlFor:"apprenants",value:"Les apprenants en fichier excel",children:[" ",e.jsx("span",{className:"text-danger",children:"*"}),"  "]}),e.jsx(v,{type:"file",name:"apprenants",id:"apprenants",required:!0,className:"form-control mt-1 block w-full",onChange:s=>f("apprenants",s.target.files[0])}),e.jsx(k,{className:"mt-2",message:g.apprenants})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(w,{onClick:p,children:"Abandonner"}),e.jsxs(S,{disabled:n,children:[e.jsx(o,{icon:M})," ",n?"Enregistrement ...":"Enregistrer les modifications"]})]})]})})]})}export{xe as default};
