import{u as z,r as h,a as B,j as e,H as q,L as x}from"./app-DbLvhVh2.js";import{A as V,c as F}from"./AuthenticatedLayout-CiGSHSdB.js";import{C as a}from"./index.esm-DzJ4LjXn.js";import{S as t}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as f,S as g}from"./SecondaryButton-DfyTKKiN.js";import{I as b}from"./InputLabel-CFjS5-ko.js";import{T as N}from"./TextInput-Be_NLXO3.js";import{I as w}from"./InputError-BgUOj-J0.js";import{P as y}from"./PrimaryButton-CaQzdX6s.js";import{c as H}from"./cil-library-add-Cbli5Ji_.js";import{c as v,a as R}from"./cil-info-CGjZWabf.js";import{c as U}from"./cil-menu-Za6MY1fF.js";import{c as k}from"./cil-pencil-m516yCOw.js";import{c as G}from"./cil-delete-tImhsUUb.js";import{c as S}from"./cil-send-haInf9fd.js";import"./transition-BM2wmKRd.js";import"./ApplicationLogo-Cw4KuVp9.js";import"./logo-CPzApIsd.js";function he({apprenants:C}){const I=z().props.auth.permissions,[M,l]=h.useState(!1),[L,o]=h.useState(!1),[n,p]=h.useState(null),c=s=>I.some(r=>r.name==s),P=s=>{t.fire({text:`Profile de : ${s.parent?.firstname} - ${s.parent?.lastname}`,imageUrl:s.photo,imageWidth:400,imageHeight:200,imageAlt:"Photo de profil",confirmButtonColor:"#1b5a38",confirmButtonText:"Merci"})},E=(s,r)=>{s.preventDefault(),p(r),o(!0)},A=(s,r)=>{s.preventDefault(),p(r),l(!0)},d=()=>{l(!1)},O=()=>{o(!1)},{data:W,setData:u,errors:j,processing:i,post:D,patch:_}=B({photo:"",apprenants:""}),T=s=>{s.preventDefault(),t.fire({title:"Opération en cours...",text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{t.showLoading()}}),D(route("apprenant.import"),{onSuccess:()=>{t.close(),t.fire({icon:"success",title:"Opération réussie",text:"Importation effectuée avec succès"}),l(!1)},onError:r=>{t.close(),t.fire({icon:"error",title:"Opération échouée",text:`${r.exception??"Veuillez vérifier vos informations et réessayer."}`}),l(!1)}})},$=s=>{s.preventDefault(),t.fire({title:"Opération en cours...",text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{t.showLoading()}}),_(route("apprenant.profile-update",n?.id),{onSuccess:()=>{t.close(),t.fire({icon:"success",title:"Opération réussie",text:"Profile mis à jour avec succès"}),o(!1)},onError:r=>{t.close(),t.fire({icon:"error",title:"Opération échouée",text:`${r.exception??"Veuillez vérifier vos informations et réessayer."}`}),o(!1)}})};return e.jsxs(V,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(a,{className:"text-success",icon:F})," Panel des listes d'apprenants"]}),children:[e.jsx(q,{title:"Les apprenants"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[c("apprenant.create")?e.jsxs("div",{className:"  items-center gap-4",children:[e.jsxs(x,{className:"mx-2 btn btn-sm bg-success bg-hover text-white",href:route("apprenant.create"),children:[" ",e.jsx(a,{className:"",icon:H})," Ajouter"]}),e.jsxs("button",{className:"btn btn-sm bg-success bg-hover text-white",onClick:s=>A(s),children:[" ",e.jsx(a,{className:"",icon:v})," Importer des apprenants"]})]}):null,e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Action"}),e.jsx("th",{scope:"col",children:"Photo"}),e.jsx("th",{scope:"col",children:"Ecole"}),e.jsx("th",{scope:"col",children:"Nom"}),e.jsx("th",{scope:"col",children:"Prénom"}),e.jsx("th",{scope:"col",children:"Parent"}),e.jsx("th",{scope:"col",children:"Classe"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Adresse"}),e.jsx("th",{scope:"col",children:"Phone"}),e.jsx("th",{scope:"col",children:"Sexe"}),e.jsx("th",{scope:"col",children:"Date de naissance"}),e.jsx("th",{scope:"col",children:"Lieu de naissance"}),e.jsx("th",{scope:"col",children:"N° Educ Master"})]})}),e.jsx("tbody",{children:C.data.map((s,r)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:r+1}),e.jsx("td",{children:e.jsxs("div",{className:"dropstart",children:[e.jsxs("button",{type:"button",className:"dropdown-toggle items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx(a,{icon:U})," Gérer"]}),e.jsxs("ul",{className:"dropdown-menu p-2 border rounded shadow","aria-labelledby":"dropdownMenuButton1",children:[c("apprenant.edit")?e.jsx("li",{children:e.jsxs(x,{className:"btn text-warning",href:route("apprenant.edit",s.id),children:[e.jsx(a,{icon:k}),"  Modifier"]})}):null,c("apprenant.delete")?e.jsx("li",{children:e.jsxs(x,{className:"btn text-danger",children:[e.jsx(a,{icon:G}),"  Supprimer"]})}):null]})]})}),e.jsx("td",{children:e.jsxs("div",{className:"badge bg-light rounded border shadow",style:{width:"50px",height:"50px",borderRadius:"50%",border:"solid 5px #f6f6f6",cursor:"pointer"},children:[e.jsx("img",{src:s.photo,onClick:m=>P(m),className:"img-fluid img-circle shadow",srcSet:""}),e.jsx(a,{className:"text-success",style:{cursor:"pointer"},icon:k,onClick:m=>E(m,s)})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border text-dark border",children:s.school?.raison_sociale})}),e.jsx("td",{children:s.firstname}),e.jsx("td",{children:s.lastname}),e.jsxs("td",{children:[s.parent?.firstname," ",s.parent?.lastname]}),e.jsxs("td",{children:[s.classe?.libelle||"--"," - ",s.serie?.libelle||"--"," "]}),e.jsx("td",{children:s.email||"--"}),e.jsx("td",{children:s.adresse||"--"}),e.jsx("td",{children:s.phone||"--"}),e.jsx("td",{children:s.sexe||"--"}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.date_naissance||"--"})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.lieu_naissance||"--"})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light border rounded text-dark",children:s.educ_master||"--"})})]},s.id))})]})]})})}),e.jsx(f,{show:L,onClose:O,children:e.jsxs("form",{onSubmit:$,className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:["Modifier le profil de l'apprenant ",e.jsx("em",{className:"text-success",children:`${n?.firstname} - ${n?.lastname}`})]}),e.jsxs("div",{className:"my-2",children:[e.jsxs(b,{htmlFor:"photo",value:"Les apprenants en fichier excel",children:[" ",e.jsx("span",{className:"text-danger",children:"*"}),"  "]}),e.jsx(N,{type:"file",name:"photo",id:"photo",required:!0,className:"form-control mt-1 block w-full",onChange:s=>u("photo",s.target.files[0])}),e.jsx(w,{className:"mt-2",message:j.photo})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(g,{onClick:d,children:"Abandonner"}),e.jsxs(y,{disabled:i,children:[e.jsx(a,{icon:S})," ",i?"Enregistrement ...":"Enregistrer les modifications"]})]})]})}),e.jsx(f,{show:M,onClose:d,children:e.jsxs("form",{onSubmit:T,className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:["Importation de nouveaux ",e.jsx("em",{className:"text-success",children:"apprenants"})]}),e.jsxs("p",{className:"alert alert-success",children:[e.jsx(a,{className:"text-success",icon:R}),e.jsxs("ul",{className:"",children:[e.jsx("li",{className:"",children:"Télecharger le modèle"}),e.jsx("li",{className:"",children:"Remplissez le modèle"}),e.jsx("li",{className:"",children:"Uploader le fichier remplit"})]})]}),e.jsx("div",{className:"my-2",children:e.jsxs("a",{target:"_blank",href:"/apprenants-model.xlsx",className:"w-100 text-white btn btn-sm bg-success btn-hover",children:[e.jsx(a,{icon:v}),"Télécharger le modèle"]})}),e.jsxs("div",{className:"my-2",children:[e.jsxs(b,{htmlFor:"apprenants",value:"Les apprenants en fichier excel",children:[" ",e.jsx("span",{className:"text-danger",children:"*"}),"  "]}),e.jsx(N,{type:"file",name:"apprenants",id:"apprenants",required:!0,className:"form-control mt-1 block w-full",onChange:s=>u("apprenants",s.target.files[0])}),e.jsx(w,{className:"mt-2",message:j.apprenants})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(g,{onClick:d,children:"Abandonner"}),e.jsxs(y,{disabled:i,children:[e.jsx(a,{icon:S})," ",i?"Enregistrement ...":"Enregistrer les modifications"]})]})]})})]})}export{he as default};
